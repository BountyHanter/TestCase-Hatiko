# Тестовое задание 

Проект представляет из себя тестовое задание для вакансии Junior Python-разработчик для Хатико-Техника.

В него входит:
- Серверная часть на Fast API для валидации\проверки IMEI
- Телеграм бот, написанный на Aiogram

---

## Функционал

### Telegram-бот:
- **Проверка IMEI:**
  Пользователь отправляет IMEI, бот проверяет его на валидность и возвращает информацию.
- **Белый список:**
  Только пользователи из белого списка могут использовать бота.

### FastAPI-сервер:
- **Авторизация:**
  Генерация токена для работы с API через админ-токен. (Не обязательно, токен добавляется при миграции)
- **Работа с белым списком:**
  Эндпоинты для добавления и проверки пользователей в белом списке. (Айди юзера тоже добавляется при миграции)
- **Проверка IMEI через API:**
  Подключение к внешнему сервису (imeicheck.net).

---

## Установка

1. Скопируйте репозиторий:
```bash
git clone git@github.com:BountyHanter/TestCase-Hatiko.gi
cd TestCase-Hatiko
 ```

2. Убедитесь, что у вас установлен Python 3.9+ и настроен виртуальный окружение
```bash
python -m venv venv
source venv/bin/activate  # Для Linux/MacOS
venv\Scripts\activate     # Для Windows
```

3. Установите зависимости
```bash
pip install -r req.txt
```

4. Создайте файл .env в корневой директории и добавьте переменные окружения которые можете скопировать из .env_template
```text
ADMIN_TOKEN= # Токен администратора (Придумайте или сгенерируйте с помощью сервиса https://generate-random.org/api-token-generator)
SERVICE_TOKEN= # Токен сервиса imeicheck.net
BACKEND_URL=http://127.0.0.1:8000  # Адрес на котором будет работать FastAPI (не меняйте его)
TG_BOT_TOKEN=  # Токен телеграм бота, возьмите его или создайте в @BotFather
TG_USER_ID= # Айди аккаунта который поместится в белый список при миграции, возьмите его в боте - @getmyid_bot
```

## Запуск

Всё запускается одним действием. После того как вы создали .env файл и поместили туда данные перейдите в директорию
проекта и запустите файл main.py
```bash
python -m app.main
```

Готово. Бот и бэкенд работают!

Заходите в бота, жмите Start или напишите в чате /start и следуйте указаниям

## ВАЖНО, бот обрабатывает IMEI только Xiaomi

## Примечания

- Вы можете перейти по адресу http://127.0.0.1:8000/docs, там будет Swagger FastAPI и вы сможете ознакомится со всеми
эндпоинтами и опробовать их
- Логи FastAPI находятся в `/app/api/logs`
- Логи Телеграм бота находятся в `bot_logs.json`